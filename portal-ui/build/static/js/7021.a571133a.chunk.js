"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[7021],{68456:function(e,n,a){a.d(n,{QT:function(){return l},YH:function(){return c},mo:function(){return o}});var t=a(61889),i=a(98021),r=a(38588),s=a(80184),o=function(){return(0,s.jsxs)(t.ZP,{container:!0,columnGap:1,children:[(0,s.jsx)(t.ZP,{children:(0,s.jsx)(r.gyG,{width:"16px",height:"16px"})}),(0,s.jsx)(t.ZP,{item:!0,children:"Open ID"})]})},l=function(){return(0,s.jsxs)(t.ZP,{container:!0,columnGap:1,children:[(0,s.jsx)(t.ZP,{children:(0,s.jsx)(i.Z,{width:"16px",height:"16px"})}),(0,s.jsx)(t.ZP,{item:!0,children:"LDAP / Active Directory"})]})},c=function(){return(0,s.jsxs)(t.ZP,{container:!0,columnGap:1,children:[(0,s.jsx)(t.ZP,{children:(0,s.jsx)(r.oyc,{width:"16px",height:"16px"})}),(0,s.jsx)(t.ZP,{item:!0,children:"Built-in"})]})}},37021:function(e,n,a){a.r(n);var t=a(93433),i=a(29439),r=a(1413),s=a(72791),o=a(60364),l=a(51691),c=a(20890),d=a(20068),u=a(13400),m=a(75952),h=a(61889),p=a(11135),x=a(25787),v=a(20165),f=a(3579),_=a(23814),Z=a(68456),g=a(84741),j=a(40968),D=a(38588),b=a(87995),N=a(25469),S=a(72401),I=a(83679),y=a(21435),k=a(37516),A=a(23508),R=a(81207),C=a(42419),P=a(27247),w=a(50896),F=a(80184),L=(0,o.$j)((function(e){return{loadingTenant:e.tenants.loadingTenant,selectedTenant:e.tenants.currentTenant,tenant:e.tenants.tenantInfo}}),null);n.default=(0,x.Z)((function(e){return(0,p.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)({adUserDnRows:{display:"flex",marginBottom:10},buttonTray:{marginLeft:10,display:"flex",height:38,"& button":{background:"#EAEAEA"}},overlayAction:{marginLeft:10,"& svg":{maxWidth:15,maxHeight:15},"& button":{background:"#EAEAEA"}}},_.oZ),_.bK),{},{loaderAlign:{textAlign:"center"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},fileItem:{marginRight:10,display:"flex","& div label":{minWidth:50},"@media (max-width: 900px)":{flexFlow:"column"}}},(0,_.Bz)(e.spacing(4))),_.QV),_.DF),_.oO),_.AK))}))(L((function(e){var n=e.classes,a=(0,N.TL)(),r=(0,o.v9)((function(e){return e.tenants.tenantInfo})),p=(0,o.v9)((function(e){return e.tenants.loadingTenant})),x=(0,s.useState)(!1),_=(0,i.Z)(x,2),L=_[0],T=_[1],U=(0,s.useState)(!1),O=(0,i.Z)(U,2),B=O[0],G=O[1],q=(0,s.useState)("Built-in"),z=(0,i.Z)(q,2),E=z[0],K=z[1],H=(0,s.useState)(""),V=(0,i.Z)(H,2),M=V[0],W=V[1],Q=(0,s.useState)(""),Y=(0,i.Z)(Q,2),$=Y[0],J=Y[1],X=(0,s.useState)(""),ee=(0,i.Z)(X,2),ne=ee[0],ae=ee[1],te=(0,s.useState)(!1),ie=(0,i.Z)(te,2),re=ie[0],se=ie[1],oe=(0,s.useState)(""),le=(0,i.Z)(oe,2),ce=le[0],de=le[1],ue=(0,s.useState)(""),me=(0,i.Z)(ue,2),he=me[0],pe=me[1],xe=(0,s.useState)(""),ve=(0,i.Z)(xe,2),fe=ve[0],_e=ve[1],Ze=(0,s.useState)(""),ge=(0,i.Z)(Ze,2),je=ge[0],De=ge[1],be=(0,s.useState)(""),Ne=(0,i.Z)(be,2),Se=Ne[0],Ie=Ne[1],ye=(0,s.useState)(""),ke=(0,i.Z)(ye,2),Ae=ke[0],Re=ke[1],Ce=(0,s.useState)(!1),Pe=(0,i.Z)(Ce,2),we=Pe[0],Fe=Pe[1],Le=(0,s.useState)(""),Te=(0,i.Z)(Le,2),Ue=Te[0],Oe=Te[1],Be=(0,s.useState)(""),Ge=(0,i.Z)(Be,2),qe=Ge[0],ze=Ge[1],Ee=(0,s.useState)(""),Ke=(0,i.Z)(Ee,2),He=Ke[0],Ve=Ke[1],Me=(0,s.useState)(""),We=(0,i.Z)(Me,2),Qe=We[0],Ye=We[1],$e=(0,s.useState)(!1),Je=(0,i.Z)($e,2),Xe=Je[0],en=Je[1],nn=(0,s.useState)(!1),an=(0,i.Z)(nn,2),tn=an[0],rn=an[1],sn=(0,s.useState)(!1),on=(0,i.Z)(sn,2),ln=on[0],cn=on[1],dn=(0,s.useState)([""]),un=(0,i.Z)(dn,2),mn=un[0],hn=un[1],pn=(0,s.useState)([""]),xn=(0,i.Z)(pn,2),vn=xn[0],fn=xn[1],_n=(0,s.useState)({}),Zn=(0,i.Z)(_n,2),gn=Zn[0],jn=Zn[1],Dn=function(e){jn((0,g.he)(gn,e))},bn=(0,s.useState)(!1),Nn=(0,i.Z)(bn,2),Sn=Nn[0],In=Nn[1];(0,s.useEffect)((function(){var e=[];"OpenID"===E&&(e=[].concat((0,t.Z)(e),[{fieldKey:"openID_CONFIGURATION_URL",required:!0,value:M},{fieldKey:"openID_clientID",required:!0,value:$},{fieldKey:"openID_secretID",required:!0,value:ne},{fieldKey:"openID_claimName",required:!0,value:he}])),"AD"===E&&(e=[].concat((0,t.Z)(e),[{fieldKey:"AD_URL",required:!0,value:je},{fieldKey:"ad_lookupBindDN",required:!0,value:Se}]));var n=(0,j.R)(e);In(0===Object.keys(n).length),jn(n)}),[E,M,$,ne,he,je,Se]);var yn=(0,s.useCallback)((function(){R.Z.invoke("GET","/api/v1/namespaces/".concat(null===r||void 0===r?void 0:r.namespace,"/tenants/").concat(null===r||void 0===r?void 0:r.name,"/identity-provider")).then((function(e){e&&(e.oidc?(K("OpenID"),W(e.oidc.configuration_url),J(e.oidc.client_id),ae(e.oidc.secret_id),de(e.oidc.callback_url),pe(e.oidc.claim_name),_e(e.oidc.scopes)):e.active_directory&&(K("AD"),De(e.active_directory.url),Ie(e.active_directory.lookup_bind_dn),Re(e.active_directory.lookup_bind_password),Oe(e.active_directory.user_dn_search_base_dn),ze(e.active_directory.user_dn_search_filter),Ve(e.active_directory.group_search_base_dn),Ye(e.active_directory.group_search_filter),en(e.active_directory.skip_tls_verification),rn(e.active_directory.server_insecure),cn(e.active_directory.server_start_tls)))})).catch((function(e){a((0,b.Ih)(e))}))}),[r,a]);(0,s.useEffect)((function(){r&&yn()}),[r,yn]);return(0,F.jsxs)(s.Fragment,{children:[(0,F.jsx)(A.Z,{title:"Save and Restart",confirmText:"Restart",cancelText:"Cancel",titleIcon:(0,F.jsx)(D.EjK,{}),isLoading:L,onClose:function(){return G(!1)},isOpen:B,onConfirm:function(){T(!0);var e={};switch(E){case"AD":e.active_directory={url:je,lookup_bind_dn:Se,lookup_bind_password:Ae,user_dn_search_base_dn:Ue,user_dn_search_filter:qe,group_search_base_dn:He,group_search_filter:Qe,skip_tls_verification:Xe,server_insecure:tn,server_start_tls:ln};break;case"OpenID":e.oidc={configuration_url:M,client_id:$,secret_id:ne,callback_url:ce,claim_name:he,scopes:fe}}R.Z.invoke("POST","/api/v1/namespaces/".concat(null===r||void 0===r?void 0:r.namespace,"/tenants/").concat(null===r||void 0===r?void 0:r.name,"/identity-provider"),e).then((function(){T(!1),G(!1),yn()})).catch((function(e){a((0,b.Ih)(e)),T(!1)}))},confirmationContent:(0,F.jsx)(l.Z,{children:"Are you sure you want to save the changes and restart the service?"})}),p?(0,F.jsx)("div",{className:n.loaderAlign,children:(0,F.jsx)(S.Z,{})}):(0,F.jsxs)(s.Fragment,{children:[(0,F.jsxs)(h.ZP,{item:!0,xs:12,children:[(0,F.jsx)("h1",{className:n.sectionTitle,children:"Identity Provider"}),(0,F.jsx)("hr",{className:n.hrClass})]}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.protocolRadioOptions,paddingBottom:1,children:(0,F.jsx)(I.Z,{currentSelection:E,id:"idp-options",name:"idp-options",label:"Protocol",onChange:function(e){K(e.target.value)},selectorOptions:[{label:(0,F.jsx)(Z.YH,{}),value:"Built-in"},{label:(0,F.jsx)(Z.mo,{}),value:"OpenID"},{label:(0,F.jsx)(Z.QT,{}),value:"AD"}]})}),"OpenID"===E&&(0,F.jsxs)(s.Fragment,{children:[(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"openID_CONFIGURATION_URL",name:"openID_CONFIGURATION_URL",onChange:function(e){W(e.target.value),Dn("openID_CONFIGURATION_URL")},label:"Configuration URL",value:M,placeholder:"https://your-identity-provider.com/.well-known/openid-configuration",error:gn.openID_CONFIGURATION_URL||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"openID_clientID",name:"openID_clientID",onChange:function(e){J(e.target.value),Dn("openID_clientID")},label:"Client ID",value:$,error:gn.openID_clientID||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{type:re?"text":"password",id:"openID_secretID",name:"openID_secretID",onChange:function(e){ae(e.target.value),Dn("openID_secretID")},label:"Secret ID",value:ne,error:gn.openID_secretID||"",required:!0,overlayIcon:re?(0,F.jsx)(v.Z,{}):(0,F.jsx)(f.Z,{}),overlayAction:function(){return se(!re)}})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"openID_callbackURL",name:"openID_callbackURL",onChange:function(e){de(e.target.value),Dn("openID_callbackURL")},label:"Callback URL",value:ce,placeholder:"https://your-console-endpoint:9443/oauth_callback",error:gn.openID_callbackURL||""})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"openID_claimName",name:"openID_claimName",onChange:function(e){pe(e.target.value),Dn("openID_claimName")},label:"Claim Name",value:he,error:gn.openID_claimName||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"openID_scopes",name:"openID_scopes",onChange:function(e){_e(e.target.value),Dn("openID_scopes")},label:"Scopes",value:fe})})]}),"AD"===E&&(0,F.jsxs)(s.Fragment,{children:[(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"AD_URL",name:"AD_URL",onChange:function(e){De(e.target.value),Dn("AD_URL")},label:"LDAP Server Address",value:je,placeholder:"ldap-server:636",error:gn.AD_URL||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(k.Z,{value:"ad_skipTLS",id:"ad_skipTLS",name:"ad_skipTLS",checked:Xe,onChange:function(e){var n=e.target.checked;en(n)},label:"Skip TLS Verification"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(k.Z,{value:"ad_serverInsecure",id:"ad_serverInsecure",name:"ad_serverInsecure",checked:tn,onChange:function(e){var n=e.target.checked;rn(n)},label:"Server Insecure"})}),tn?(0,F.jsxs)(h.ZP,{item:!0,xs:12,children:[(0,F.jsx)(c.Z,{className:n.error,variant:"caption",display:"block",gutterBottom:!0,children:"Warning: All traffic with Active Directory will be unencrypted"}),(0,F.jsx)("br",{})]}):null,(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(k.Z,{value:"ad_serverStartTLS",id:"ad_serverStartTLS",name:"ad_serverStartTLS",checked:ln,onChange:function(e){var n=e.target.checked;cn(n)},label:"Start TLS connection to AD/LDAP server"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"ad_lookupBindDN",name:"ad_lookupBindDN",onChange:function(e){Ie(e.target.value),Dn("ad_lookupBindDN")},label:"Lookup Bind DN",value:Se,placeholder:"cn=admin,dc=min,dc=io",error:gn.ad_lookupBindDN||"",required:!0})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{type:we?"text":"password",id:"ad_lookupBindPassword",name:"ad_lookupBindPassword",onChange:function(e){Re(e.target.value)},label:"Lookup Bind Password",value:Ae,placeholder:"admin",overlayIcon:we?(0,F.jsx)(v.Z,{}):(0,F.jsx)(f.Z,{}),overlayAction:function(){return Fe(!we)}})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"ad_userDNSearchBaseDN",name:"ad_userDNSearchBaseDN",onChange:function(e){Oe(e.target.value)},label:"User DN Search Base DN",value:Ue,placeholder:"dc=min,dc=io"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"ad_userDNSearchFilter",name:"ad_userDNSearchFilter",onChange:function(e){ze(e.target.value)},label:"User DN Search Filter",value:qe,placeholder:"(sAMAcountName=%s)"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"ad_groupSearchBaseDN",name:"ad_groupSearchBaseDN",onChange:function(e){Ve(e.target.value)},label:"Group Search Base DN",value:He,placeholder:"ou=hwengg,dc=min,dc=io;ou=swengg,dc=min,dc=io"})}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.formFieldRow,children:(0,F.jsx)(y.Z,{id:"ad_groupSearchFilter",name:"ad_groupSearchFilter",onChange:function(e){Ye(e.target.value)},label:"Group Search Filter",value:Qe,placeholder:"(&(objectclass=groupOfNames)(member=%s))"})})]}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.buttonContainer,children:(0,F.jsx)(m.zx,{id:"save-idp",type:"submit",variant:"callAction",color:"primary",disabled:!Sn||L,onClick:function(){return G(!0)},label:"Save"})}),"AD"===E&&(0,F.jsxs)(s.Fragment,{children:[(0,F.jsx)(w.Z,{children:"User & Group management"}),(0,F.jsx)("br",{}),(0,F.jsxs)("fieldset",{className:n.fieldGroup,children:[(0,F.jsx)("legend",{className:n.descriptionText,children:"List of user DNs (Distinguished Names) to be added as Tenant Administrators"}),(0,F.jsx)(h.ZP,{item:!0,xs:12,children:mn.map((function(e,a){return(0,F.jsx)(s.Fragment,{children:(0,F.jsxs)("div",{className:n.adUserDnRows,children:[(0,F.jsx)(y.Z,{id:"ad-userdn-".concat(a.toString()),label:"",placeholder:"",name:"ad-userdn-".concat(a.toString()),value:mn[a],onChange:function(e){hn(mn.map((function(n,t){return t===a?e.target.value:n})))},index:a,error:gn["ad-userdn-".concat(a.toString())]||""},"csv-ad-userdn-".concat(a.toString())),(0,F.jsxs)("div",{className:n.buttonTray,children:[(0,F.jsx)(d.Z,{title:"Add User","aria-label":"add",children:(0,F.jsx)(u.Z,{size:"small",onClick:function(){hn([].concat((0,t.Z)(mn),[""]))},children:(0,F.jsx)(C.Z,{})})}),(0,F.jsx)(d.Z,{title:"Remove","aria-label":"add",children:(0,F.jsx)(u.Z,{size:"small",style:{marginLeft:16},onClick:function(){mn.length>1&&hn(mn.filter((function(e,n){return n!==a})))},children:(0,F.jsx)(P.Z,{})})})]})]})},"identityField-".concat(a.toString()))}))})]}),(0,F.jsxs)("fieldset",{className:n.fieldGroup,children:[(0,F.jsx)("legend",{className:n.descriptionText,children:"List of group DNs (Distinguished Names) to be added as Tenant Administrators"}),(0,F.jsx)(h.ZP,{item:!0,xs:12,children:vn.map((function(e,a){return(0,F.jsx)(s.Fragment,{children:(0,F.jsxs)("div",{className:n.adUserDnRows,children:[(0,F.jsx)(y.Z,{id:"ad-groupdn-".concat(a.toString()),label:"",placeholder:"",name:"ad-groupdn-".concat(a.toString()),value:vn[a],onChange:function(e){fn(vn.map((function(n,t){return t===a?e.target.value:n})))},index:a,error:gn["ad-groupdn-".concat(a.toString())]||""},"csv-ad-groupdn-".concat(a.toString())),(0,F.jsxs)("div",{className:n.buttonTray,children:[(0,F.jsx)(d.Z,{title:"Add Group","aria-label":"add",children:(0,F.jsx)(u.Z,{size:"small",onClick:function(){fn([].concat((0,t.Z)(vn),[""]))},children:(0,F.jsx)(C.Z,{})})}),(0,F.jsx)(d.Z,{title:"Remove","aria-label":"add",children:(0,F.jsx)(u.Z,{size:"small",style:{marginLeft:16},onClick:function(){vn.length>1&&fn(vn.filter((function(e,n){return n!==a})))},children:(0,F.jsx)(P.Z,{})})})]})]})},"identityField-".concat(a.toString()))}))})]}),(0,F.jsx)("br",{}),(0,F.jsx)(h.ZP,{item:!0,xs:12,className:n.buttonContainer,children:(0,F.jsx)(m.zx,{id:"add-additional-dns",type:"submit",variant:"callAction",disabled:!Sn||L,onClick:function(){return function(){T(!0);var e={};"AD"===E&&(e={user_dns:mn.filter((function(e){return""!==e.trim()})),group_dns:vn.filter((function(e){return""!==e.trim()}))});R.Z.invoke("POST","/api/v1/namespaces/".concat(null===r||void 0===r?void 0:r.namespace,"/tenants/").concat(null===r||void 0===r?void 0:r.name,"/set-administrators"),e).then((function(){T(!1),fn([""]),hn([""]),yn(),a((0,b.y1)("Administrators added successfully"))})).catch((function(e){a((0,b.Ih)(e)),T(!1)}))}()},label:"Add additional DNs"})})]})]})]})})))},42419:function(e,n,a){var t=a(64836);n.Z=void 0;var i=t(a(45649)),r=a(80184),s=(0,i.default)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");n.Z=s},27247:function(e,n,a){var t=a(64836);n.Z=void 0;var i=t(a(45649)),r=a(80184),s=(0,i.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");n.Z=s}}]);
//# sourceMappingURL=7021.a571133a.chunk.js.map