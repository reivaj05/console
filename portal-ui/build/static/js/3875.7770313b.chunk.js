"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[3875],{23804:function(e,n,i){i(72791);var t=i(11135),r=i(25787),s=i(61889),a=i(80184);n.Z=(0,r.Z)((function(e){return(0,t.Z)({root:{border:"1px solid #E2E2E2",borderRadius:2,backgroundColor:"#FBFAFA",paddingLeft:25,paddingTop:31,paddingBottom:21,paddingRight:30},leftItems:{fontSize:16,fontWeight:"bold",marginBottom:15,display:"flex",alignItems:"center","& .min-icon":{marginRight:15,height:28,width:38}},helpText:{fontSize:16,paddingLeft:5}})}))((function(e){var n=e.classes,i=e.iconComponent,t=e.title,r=e.help;return(0,a.jsx)("div",{className:n.root,children:(0,a.jsxs)(s.ZP,{container:!0,children:[(0,a.jsxs)(s.ZP,{item:!0,xs:12,className:n.leftItems,children:[i,t]}),(0,a.jsx)(s.ZP,{item:!0,xs:12,className:n.helpText,children:r})]})})}))},27454:function(e,n,i){var t=i(1413),r=i(72791),s=i(20068),a=i(80184);n.Z=function(e){var n=e.tooltip,i=e.children,o=e.errorProps,c=void 0===o?null:o;return(0,a.jsx)(s.Z,{title:n,children:(0,a.jsx)("span",{children:c?(0,r.cloneElement)(i,(0,t.Z)({},c)):i})})}},93875:function(e,n,i){i.r(n),i.d(n,{default:function(){return F}});var t=i(93433),r=i(4942),s=i(1413),a=i(29439),o=i(72791),c=i(61889),d=i(64554),l=i(40986),p=i(16871),x=i(75952),u=i(9505),f=i(38588),h=i(32291),g=i(84669),m=i(56087),j=i(74794),y=i(23804),v=i(50896),Z=i(87995),K=i(25469),b=i(60364),C=i(46078),S=i(21435),w=i(27454),k=i(80184),T=function(e){var n=e.rowData,i=e.rowId,t=e.onFieldChange,r=e.onAddClick,s=e.onRemoveClick,a=e.canAdd,l=void 0===a||a,p=e.canRemove,u=void 0===p||p,h=e.showRowActions,g=void 0===h||h,m=e.disabledFields,j=void 0===m?[]:m,y=e.fieldErrors,v=void 0===y?{}:y,Z=n.endpoint,K=void 0===Z?"":Z,b=n.accessKey,C=void 0===b?"":b,T=n.secretKey,I=void 0===T?"":T,R=n.name,A=void 0===R?"":R;return(0,k.jsxs)(o.Fragment,{children:[(0,k.jsx)(d.Z,{children:(0,k.jsx)(S.Z,{id:"add-rep-peer-site-".concat(i),name:"add-rep-peer-site-".concat(i),placeholder:"site-name",label:"",extraInputProps:{readOnly:j.includes("name")},value:A,onChange:function(e){t(e,"name",i)},"data-test-id":"add-site-rep-peer-site-".concat(i)})}),(0,k.jsx)(d.Z,{children:(0,k.jsx)(S.Z,{id:"add-rep-peer-site-ep-".concat(i),name:"add-rep-peer-site-ep-".concat(i),placeholder:"https://dr.minio-storage:900".concat(i),label:"",extraInputProps:{readOnly:j.includes("endpoint")},error:v.endpoint,value:K,onChange:function(e){t(e,"endpoint",i)},"data-test-id":"add-site-rep-peer-ep-".concat(i)})}),(0,k.jsx)(d.Z,{children:(0,k.jsx)(S.Z,{id:"add-rep-peer-site-ac-".concat(i),name:"add-rep-peer-site-ac-".concat(i),label:"",required:!0,disabled:j.includes("accessKey"),value:C,error:v.accessKey,onChange:function(e){t(e,"accessKey",i)},"data-test-id":"add-rep-peer-site-ac-".concat(i)})}),(0,k.jsx)(d.Z,{children:(0,k.jsx)(S.Z,{id:"add-rep-peer-site-sk-".concat(i),name:"add-rep-peer-site-sk-".concat(i),label:"",required:!0,type:"password",value:I,error:v.secretKey,disabled:j.includes("secretKey"),onChange:function(e){t(e,"secretKey",i)},"data-test-id":"add-rep-peer-site-sk-".concat(i)})}),(0,k.jsx)(c.ZP,{item:!0,xs:12,alignItems:"center",display:"flex",children:(0,k.jsx)(d.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"baseline",marginTop:"4px","& button":{borderColor:"#696969",color:"#696969",borderRadius:"50%"}},children:g?(0,k.jsxs)(o.Fragment,{children:[(0,k.jsx)(w.Z,{tooltip:"Add a Row",children:(0,k.jsx)(x.zx,{id:"add-row-".concat(i),variant:"regular",disabled:!l,icon:(0,k.jsx)(f.dtP,{}),onClick:function(e){e.preventDefault(),null===r||void 0===r||r(i)},style:{width:25,height:25,padding:0}})}),(0,k.jsx)(w.Z,{tooltip:"Remove Row",children:(0,k.jsx)(x.zx,{id:"remove-row-".concat(i),variant:"regular",disabled:!u,icon:(0,k.jsx)(f.HFL,{}),onClick:function(e){e.preventDefault(),null===s||void 0===s||s(i)},style:{width:25,height:25,padding:0,marginLeft:8}})})]}):null})})]},"".concat(i))},I=function(e){var n=!1;try{new URL(e),n=!0}catch(i){n=!1}return n?"":"Invalid Endpoint"},R=function(e){return""===(null===e||void 0===e?void 0:e.trim())},A=function(){return(0,k.jsxs)(o.Fragment,{children:[(0,k.jsx)(d.Z,{sx:{fontSize:"14px",marginLeft:"5px"},children:"Site Name"}),(0,k.jsxs)(d.Z,{sx:{fontSize:"14px",marginLeft:"5px"},children:["Endpoint ","*"]}),(0,k.jsxs)(d.Z,{sx:{fontSize:"14px",marginLeft:"5px"},children:["Access Key ","*"]}),(0,k.jsxs)(d.Z,{sx:{fontSize:"14px",marginLeft:"5px"},children:["Secret Key ","*"]}),(0,k.jsx)(d.Z,{children:" "})]})},E=function(e){var n=e.title;return(0,k.jsx)(c.ZP,{item:!0,xs:12,children:(0,k.jsx)(d.Z,{sx:{marginBottom:"15px",fontSize:"14px",fontWeight:600},children:n})})},F=function(){var e=(0,K.TL)(),n=(0,p.s0)(),i=(0,b.v9)(C.gK).serverEndPoint,S=void 0===i?"":i,w=(0,o.useState)([{endpoint:S,name:"",accessKey:"",secretKey:""}]),F=(0,a.Z)(w,2),B=F[0],P=F[1],z=(0,o.useState)([]),L=(0,a.Z)(z,2),N=L[0],q=L[1],O=function(){q([{endpoint:"",name:"",accessKey:"",secretKey:""}])},W=(0,u.Z)((function(e){var n=e.sites,i=e.name,t=n.findIndex((function(e){return e.name===i}));if(-1!==t){var r=n[t];r=(0,s.Z)((0,s.Z)({},r),{},{isCurrent:!0,isSaved:!0}),P([r]),n.splice(t,1)}n.sort((function(e,n){return e.name===i?-1:n.name===i?1:0}));var a=n.map((function(e){return(0,s.Z)((0,s.Z)({},e),{},{accessKey:"",secretKey:"",isSaved:!0})}));a.length?q(a):O()}),(function(e){O()})),D=(0,a.Z)(W,2),_=D[0],H=D[1],M=function(){H("GET","api/v1/admin/site-replication")};(0,o.useEffect)((function(){M()}),[]);var Y=N.reduce((function(e,n,i){var t=N[i].endpoint,r=I(t);return""===r&&""!==t&&e.push(r),e}),[]),G=N.map((function(e){return!R(e.accessKey)&&!R(e.secretKey)})).filter(Boolean),U=B[0],V=U.accessKey,J=U.secretKey,Q=!R(V)&&!R(J),X=Y.length===N.length,$=G.length===N.length,ee=Q&&X&&$,ne=(0,u.Z)((function(i){i.success?(e((0,Z.y1)(i.status)),se(),M(),n(m.gA.SITE_REPLICATION)):e((0,Z.Ih)({errorMessage:"Error",detailedError:i.status}))}),(function(n){e((0,Z.Ih)(n))})),ie=(0,a.Z)(ne,2),te=ie[0],re=ie[1],se=function(){O(),P((function(e){return e.map((function(e,n){return(0,s.Z)((0,s.Z)({},e),{},{accessKey:"",secretKey:"",name:""})}))}))};return(0,k.jsxs)(o.Fragment,{children:[(0,k.jsx)(h.Z,{label:(0,k.jsx)(g.Z,{to:m.gA.SITE_REPLICATION,label:"Add Replication Site"})}),(0,k.jsx)(j.Z,{children:(0,k.jsxs)(d.Z,{sx:{display:"grid",padding:"25px",gap:"25px",gridTemplateColumns:"1fr",border:"1px solid #eaeaea"},children:[(0,k.jsxs)(d.Z,{children:[(0,k.jsx)(v.Z,{icon:(0,k.jsx)(f.aWt,{}),children:"Add Sites for Replication"}),_||te?(0,k.jsx)(l.Z,{}):null,(0,k.jsx)(d.Z,{sx:{fontSize:"14px",fontStyle:"italic",marginTop:"10px",marginBottom:"10px"},children:"Note: AccessKey and SecretKey values for every site is required while adding or editing peer sites"}),(0,k.jsxs)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){return e.preventDefault(),function(){var e=null===B||void 0===B?void 0:B.map((function(e,n){return{accessKey:e.accessKey,secretKey:e.secretKey,name:e.name,endpoint:e.endpoint}})),n=N.reduce((function(e,n,i){return n.endpoint&&e.push({accessKey:n.accessKey,secretKey:n.secretKey,name:n.name||"dr-site-".concat(i),endpoint:n.endpoint}),e}),[]),i=e.concat(n);re("POST","api/v1/admin/site-replication",i)}()},children:[(0,k.jsxs)(d.Z,{sx:{marginTop:"15px"},children:[(0,k.jsx)(E,{title:"This Site"}),(0,k.jsxs)(d.Z,{sx:{display:"grid",gridTemplateColumns:".8fr 1.2fr .8fr .8fr .2fr",border:"1px solid #eaeaea",padding:"15px",gap:"10px",maxHeight:"430px",overflowY:"auto"},children:[(0,k.jsx)(A,{}),B.map((function(e,n){var i=R(e.accessKey)?"AccessKey is required":"",t=R(e.secretKey)?"SecretKey is required":"";return(0,k.jsx)(T,{disabledFields:["endpoint"].concat(e.isSaved?"name":""),rowData:e,rowId:n,fieldErrors:{accessKey:i,secretKey:t},onFieldChange:function(e,n,i){var t=e.target.value;""!==n&&P((function(e){return e.map((function(e,a){return a===i?(0,s.Z)((0,s.Z)({},e),{},(0,r.Z)({},n,t)):e}))}))},showRowActions:!1},"current-".concat(n))}))]})]}),(0,k.jsxs)(d.Z,{sx:{marginTop:"25px"},children:[(0,k.jsx)(E,{title:"Peer Sites"}),(0,k.jsxs)(d.Z,{sx:{display:"grid",gridTemplateColumns:".8fr 1.2fr .8fr .8fr .2fr",border:"1px solid #eaeaea",padding:"15px",gap:"10px",maxHeight:"430px",overflowY:"auto"},children:[(0,k.jsx)(A,{}),N.map((function(e,n){var i=I(e.endpoint),a=R(e.accessKey)?"AccessKey is required":"",o=R(e.secretKey)?"SecretKey is required":"";return(0,k.jsx)(T,{rowData:e,rowId:n,fieldErrors:{endpoint:i,accessKey:a,secretKey:o},disabledFields:e.isSaved?["endpoint","name"]:[],onFieldChange:function(e,n,i){var t=e.target.value;q((function(e){return e.map((function(e,a){return a===i?(0,s.Z)((0,s.Z)({},e),{},(0,r.Z)({},n,t)):e}))}))},canAdd:!0,canRemove:n>0&&!e.isSaved,onAddClick:function(){var e=(0,t.Z)(N);e.splice(n+1,0,{name:"",endpoint:"",accessKey:"",secretKey:""}),q(e)},onRemoveClick:function(e){q(N.filter((function(n,i){return i!==e})))}},"exiting-".concat(n))}))]})]}),(0,k.jsx)(c.ZP,{item:!0,xs:12,children:(0,k.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:"20px",gap:"15px"},children:[(0,k.jsx)(x.zx,{id:"clear",type:"button",variant:"regular",disabled:te,onClick:se,label:"Clear"}),(0,k.jsx)(x.zx,{id:"save",type:"submit",variant:"callAction",disabled:te||!ee,label:"Save"})]})})]})]}),(0,k.jsx)(y.Z,{title:"",iconComponent:null,help:(0,k.jsxs)(o.Fragment,{children:[(0,k.jsxs)(d.Z,{sx:{marginTop:"-25px",fontSize:"16px",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"2px"},children:[(0,k.jsx)(d.Z,{sx:{backgroundColor:"#07193E",height:"15px",width:"15px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",marginRight:"18px",padding:"3px",paddingLeft:"2px","& .min-icon":{height:"11px",width:"11px",fill:"#ffffff"}},children:(0,k.jsx)(f.aWt,{})}),"About Site Replication"]}),(0,k.jsxs)(d.Z,{sx:{display:"flex",flexFlow:"column",fontSize:"14px",flex:"2","& .step-number":{color:"#ffffff",height:"25px",width:"25px",background:"#081C42",marginRight:"10px",textAlign:"center",fontWeight:600,borderRadius:"50%"},"& li":{fontSize:"14px",display:"flex",marginTop:"15px",marginBottom:"15px",width:"100%","&.step-text":{fontWeight:400},"&:before":{content:"' '",height:"7px",width:"7px",backgroundColor:"#2781B0",marginRight:"10px",marginTop:"12px",flexShrink:0}}},children:[(0,k.jsx)(d.Z,{children:"The following changes are replicated to all other sites"}),(0,k.jsxs)("ul",{children:[(0,k.jsx)("li",{children:"Creation and deletion of buckets and objects"}),(0,k.jsx)("li",{children:"Creation and deletion of all IAM users, groups, policies and their mappings to users or groups"}),(0,k.jsx)("li",{children:"Creation of STS credentials"}),(0,k.jsx)("li",{children:"Creation and deletion of service accounts (except those owned by the root user)"}),(0,k.jsx)("li",{children:(0,k.jsxs)(d.Z,{style:{display:"flex",flexFlow:"column",justifyContent:"flex-start"},children:[(0,k.jsx)("div",{style:{paddingTop:"1px"},children:"Changes to Bucket features such as"}),(0,k.jsxs)("ul",{children:[(0,k.jsx)("li",{children:"Bucket Policies"}),(0,k.jsx)("li",{children:"Bucket Tags"}),(0,k.jsx)("li",{children:"Bucket Object-Lock configurations"}),(0,k.jsx)("li",{children:"Bucket Encryption configuration"})]})]})}),(0,k.jsx)("li",{children:(0,k.jsxs)(d.Z,{style:{display:"flex",flexFlow:"column",justifyContent:"flex-start"},children:[(0,k.jsx)("div",{style:{paddingTop:"1px"},children:"The following Bucket features will NOT be replicated"}),(0,k.jsxs)("ul",{children:[(0,k.jsx)("li",{children:"Bucket notification configuration"}),(0,k.jsx)("li",{children:"Bucket lifecycle (ILM) configuration"})]})]})})]})]})]})})]})})]})}}}]);
//# sourceMappingURL=3875.7770313b.chunk.js.map